/*
 * searchtools.js_t
 * ~~~~~~~~~~~~~~~~
 *
 * Sphinx JavaScript utilties for the full-text search.
 *
 * :copyright: Copyright 2007-2011 by the Sphinx team, see AUTHORS.
 * :license: BSD, see LICENSE for details.
 *
 *//**
 * helper function to return a node containing the
 * search summary for a given text. keywords is a list
 * of stemmed words, hlwords is the list of normal, unstemmed
 * words. the first one is used to find the occurance, the
 * latter for highlighting it.
 */jQuery.makeSearchSummary=function(e,t,n){var r=e.toLowerCase(),i=0;$.each(t,function(){var e=r.indexOf(this.toLowerCase());e>-1&&(i=e)});i=Math.max(i-120,0);var s=(i>0?"...":"")+$.trim(e.substr(i,240))+(i+240-e.length?"...":""),o=$('<div class="context"></div>').text(s);$.each(n,function(){o=o.highlightText(this,"highlighted")});return o};var Stemmer=function(){var e={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},t={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},n="[^aeiou]",r="[aeiouy]",i=n+"[^aeiouy]*",s=r+"[aeiou]*",o="^("+i+")?"+s+i,u="^("+i+")?"+s+i+"("+s+")?$",a="^("+i+")?"+s+i+s+i,f="^("+i+")?"+r;this.stemWord=function(n){var s,l,c,h=n;if(n.length<3)return n;var p,d,m,g;c=n.substr(0,1);c=="y"&&(n=c.toUpperCase()+n.substr(1));p=/^(.+?)(ss|i)es$/;d=/^(.+?)([^s])s$/;p.test(n)?n=n.replace(p,"$1$2"):d.test(n)&&(n=n.replace(d,"$1$2"));p=/^(.+?)eed$/;d=/^(.+?)(ed|ing)$/;if(p.test(n)){var y=p.exec(n);p=new RegExp(o);if(p.test(y[1])){p=/.$/;n=n.replace(p,"")}}else if(d.test(n)){var y=d.exec(n);s=y[1];d=new RegExp(f);if(d.test(s)){n=s;d=/(at|bl|iz)$/;m=new RegExp("([^aeiouylsz])\\1$");g=new RegExp("^"+i+r+"[^aeiouwxy]$");if(d.test(n))n+="e";else if(m.test(n)){p=/.$/;n=n.replace(p,"")}else g.test(n)&&(n+="e")}}p=/^(.+?)y$/;if(p.test(n)){var y=p.exec(n);s=y[1];p=new RegExp(f);p.test(s)&&(n=s+"i")}p=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;if(p.test(n)){var y=p.exec(n);s=y[1];l=y[2];p=new RegExp(o);p.test(s)&&(n=s+e[l])}p=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;if(p.test(n)){var y=p.exec(n);s=y[1];l=y[2];p=new RegExp(o);p.test(s)&&(n=s+t[l])}p=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;d=/^(.+?)(s|t)(ion)$/;if(p.test(n)){var y=p.exec(n);s=y[1];p=new RegExp(a);p.test(s)&&(n=s)}else if(d.test(n)){var y=d.exec(n);s=y[1]+y[2];d=new RegExp(a);d.test(s)&&(n=s)}p=/^(.+?)e$/;if(p.test(n)){var y=p.exec(n);s=y[1];p=new RegExp(a);d=new RegExp(u);m=new RegExp("^"+i+r+"[^aeiouwxy]$");if(p.test(s)||d.test(s)&&!m.test(s))n=s}p=/ll$/;d=new RegExp(a);if(p.test(n)&&d.test(n)){p=/.$/;n=n.replace(p,"")}c=="y"&&(n=c.toLowerCase()+n.substr(1));return n}},Search={_index:null,_queued_query:null,_pulse_status:-1,init:function(){var e=$.getQueryParameters();if(e.q){var t=e.q[0];$('input[name="q"]')[0].value=t;this.performSearch(t)}},loadIndex:function(e){$.ajax({type:"GET",url:e,data:null,success:null,dataType:"script",cache:!0})},setIndex:function(e){var t;this._index=e;if((t=this._queued_query)!==null){this._queued_query=null;Search.query(t)}},hasIndex:function(){return this._index!==null},deferQuery:function(e){this._queued_query=e},stopPulse:function(){this._pulse_status=0},startPulse:function(){function e(){Search._pulse_status=(Search._pulse_status+1)%4;var t="";for(var n=0;n<Search._pulse_status;n++)t+=".";Search.dots.text(t);Search._pulse_status>-1&&window.setTimeout(e,500)}if(this._pulse_status>=0)return;e()},performSearch:function(e){this.out=$("#search-results");this.title=$("<h2>"+_("Searching")+"</h2>").appendTo(this.out);this.dots=$("<span></span>").appendTo(this.title);this.status=$('<p style="display: none"></p>').appendTo(this.out);this.output=$('<ul class="search"/>').appendTo(this.out);$("#search-progress").text(_("Preparing search..."));this.startPulse();this.hasIndex()?this.query(e):this.deferQuery(e)},query:function(e){function k(){if(S.length){var e=S.pop(),t=$('<li style="display:none"></li>');if(DOCUMENTATION_OPTIONS.FILE_SUFFIX==""){var n=e[0]+"/";n.match(/\/index\/$/)?n=n.substring(0,n.length-6):n=="index/"&&(n="");t.append($("<a/>").attr("href",DOCUMENTATION_OPTIONS.URL_ROOT+n+c+e[2]).html(e[1]))}else t.append($("<a/>").attr("href",e[0]+DOCUMENTATION_OPTIONS.FILE_SUFFIX+c+e[2]).html(e[1]));if(e[3]){t.append($("<span> ("+e[3]+")</span>"));Search.output.append(t);t.slideDown(5,function(){k()})}else if(DOCUMENTATION_OPTIONS.HAS_SOURCE)$.get(DOCUMENTATION_OPTIONS.URL_ROOT+"_sources/"+e[0]+".txt",function(e){if(e!=""){t.append($.makeSearchSummary(e,r,s));Search.output.append(t)}t.slideDown(5,function(){k()})},"text");else{Search.output.append(t);t.slideDown(5,function(){k()})}}else{Search.stopPulse();Search.title.text(_("Search Results"));C?Search.status.text(_("Search finished, found %s page(s) matching the search query.").replace("%s",C)):Search.status.text(_("Your search did not match any documents. Please make sure that all words are spelled correctly and that you've selected enough categories."));Search.status.fadeIn(500)}}var t=["and","then","into","it","as","are","in","if","for","no","there","their","was","is","be","to","that","but","they","not","such","with","by","a","on","these","of","will","this","near","the","or","at"],n=new Stemmer,r=[],i=[],s=[],o=e.split(/\s+/),u=[];for(var a=0;a<o.length;a++){o[a]!=""&&u.push(o[a].toLowerCase());if($u.indexOf(t,o[a])!=-1||o[a].match(/^\d+$/)||o[a]=="")continue;var f=n.stemWord(o[a]).toLowerCase();if(f[0]=="-"){var l=i;f=f.substr(1)}else{var l=r;s.push(o[a].toLowerCase())}$.contains(l,f)||l.push(f)}var c="?highlight="+$.urlencode(s.join(" ")),h=this._index.filenames,p=this._index.titles,d=this._index.terms,v={},m=null,g=[],y=[],b=[],w=[];$("#search-progress").empty();for(var a=0;a<u.length;a++){var E=[].concat(u.slice(0,a),u.slice(a+1,u.length)),S=this.performObjectSearch(u[a],E);y=S[0].concat(y);g=S[1].concat(g);w=S[2].concat(w)}for(var a=0;a<r.length;a++){var f=r[a];if((m=d[f])==null)break;m.length==undefined&&(m=[m]);for(var x=0;x<m.length;x++){var T=m[x];T in v?v[T].push(f):v[T]=[f]}}for(var T in v){var N=!0;if(v[T].length!=r.length)continue;for(var a=0;a<i.length;a++)if(d[i[a]]==T||$.contains(d[i[a]]||[],T)){N=!1;break}N&&b.push([h[T],p[T],"",null])}delete h,p,d;b.sort(function(e,t){var n=e[1].toLowerCase(),r=t[1].toLowerCase();return n>r?-1:n<r?1:0});var S=w.concat(b).concat(y).concat(g),C=S.length;k()},performObjectSearch:function(e,t){var n=this._index.filenames,r=this._index.objects,i=this._index.objnames,s=this._index.titles,o=[],u=[],a=[];for(var f in r)for(var l in r[f]){var c=(f?f+".":"")+l;if(c.toLowerCase().indexOf(e)>-1){var h=r[f][l],p=i[h[1]][2],d=s[h[0]];if(t.length>0){var v=(f+" "+l+" "+p+" "+d).toLowerCase(),m=!0;for(var g=0;g<t.length;g++)if(v.indexOf(t[g])==-1){m=!1;break}if(!m)continue}var y=p+_(", in ")+d;anchor=h[3];anchor==""?anchor=c:anchor=="-"&&(anchor=i[h[1]][1]+"-"+c);result=[n[h[0]],c,"#"+anchor,y];switch(h[2]){case 1:u.push(result);break;case 0:o.push(result);break;case 2:a.push(result)}}}u.sort(function(e,t){return e[1]>t[1]?-1:e[1]<t[1]?1:0});o.sort(function(e,t){return e[1]>t[1]?-1:e[1]<t[1]?1:0});a.sort(function(e,t){return e[1]>t[1]?-1:e[1]<t[1]?1:0});return[o,u,a]}};$(document).ready(function(){Search.init()});