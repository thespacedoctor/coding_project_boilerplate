// Underscore.js 0.5.5
// (c) 2009 Jeremy Ashkenas, DocumentCloud Inc.
// Underscore is freely distributable under the terms of the MIT license.
// Portions of Underscore are inspired by or borrowed from Prototype.js,
// Oliver Steele's Functional, and John Resig's Micro-Templating.
// For all details and documentation:
// http://documentcloud.github.com/underscore/
(function(){var e=this,t=e._,n=function(e){this._wrapped=e},r=typeof StopIteration!="undefined"?StopIteration:"__break__",i=e._=function(e){return new n(e)};typeof exports!="undefined"&&(exports._=i);var s=Array.prototype.slice,o=Array.prototype.unshift,u=Object.prototype.toString,a=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;i.VERSION="0.5.5";i.each=function(e,t,n){try{if(e.forEach)e.forEach(t,n);else if(i.isArray(e)||i.isArguments(e))for(var s=0,o=e.length;s<o;s++)t.call(n,e[s],s,e);else{var u=i.keys(e);o=u.length;for(s=0;s<o;s++)t.call(n,e[u[s]],u[s],e)}}catch(a){if(a!=r)throw a}return e};i.map=function(e,t,n){if(e&&i.isFunction(e.map))return e.map(t,n);var r=[];i.each(e,function(e,i,s){r.push(t.call(n,e,i,s))});return r};i.reduce=function(e,t,n,r){if(e&&i.isFunction(e.reduce))return e.reduce(i.bind(n,r),t);i.each(e,function(e,i,s){t=n.call(r,t,e,i,s)});return t};i.reduceRight=function(e,t,n,r){if(e&&i.isFunction(e.reduceRight))return e.reduceRight(i.bind(n,r),t);var s=i.clone(i.toArray(e)).reverse();i.each(s,function(i,s){t=n.call(r,t,i,s,e)});return t};i.detect=function(e,t,n){var r;i.each(e,function(e,s,o){if(t.call(n,e,s,o)){r=e;i.breakLoop()}});return r};i.select=function(e,t,n){if(e&&i.isFunction(e.filter))return e.filter(t,n);var r=[];i.each(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)});return r};i.reject=function(e,t,n){var r=[];i.each(e,function(e,i,s){!t.call(n,e,i,s)&&r.push(e)});return r};i.all=function(e,t,n){t=t||i.identity;if(e&&i.isFunction(e.every))return e.every(t,n);var r=!0;i.each(e,function(e,s,o){(r=r&&t.call(n,e,s,o))||i.breakLoop()});return r};i.any=function(e,t,n){t=t||i.identity;if(e&&i.isFunction(e.some))return e.some(t,n);var r=!1;i.each(e,function(e,s,o){(r=t.call(n,e,s,o))&&i.breakLoop()});return r};i.include=function(e,t){if(i.isArray(e))return i.indexOf(e,t)!=-1;var n=!1;i.each(e,function(e){(n=e===t)&&i.breakLoop()});return n};i.invoke=function(e,t){var n=i.rest(arguments,2);return i.map(e,function(e){return(t?e[t]:e).apply(e,n)})};i.pluck=function(e,t){return i.map(e,function(e){return e[t]})};i.max=function(e,t,n){if(!t&&i.isArray(e))return Math.max.apply(Math,e);var r={computed:-Infinity};i.each(e,function(e,i,s){i=t?t.call(n,e,i,s):e;i>=r.computed&&(r={value:e,computed:i})});return r.value};i.min=function(e,t,n){if(!t&&i.isArray(e))return Math.min.apply(Math,e);var r={computed:Infinity};i.each(e,function(e,i,s){i=t?t.call(n,e,i,s):e;i<r.computed&&(r={value:e,computed:i})});return r.value};i.sortBy=function(e,t,n){return i.pluck(i.map(e,function(e,r,i){return{value:e,criteria:t.call(n,e,r,i)}}).sort(function(e,t){e=e.criteria;t=t.criteria;return e<t?-1:e>t?1:0}),"value")};i.sortedIndex=function(e,t,n){n=n||i.identity;for(var r=0,s=e.length;r<s;){var o=r+s>>1;n(e[o])<n(t)?r=o+1:s=o}return r};i.toArray=function(e){return e?e.toArray?e.toArray():i.isArray(e)?e:i.isArguments(e)?s.call(e):i.values(e):[]};i.size=function(e){return i.toArray(e).length};i.first=function(e,t,n){return t&&!n?s.call(e,0,t):e[0]};i.rest=function(e,t,n){return s.call(e,i.isUndefined(t)||n?1:t)};i.last=function(e){return e[e.length-1]};i.compact=function(e){return i.select(e,function(e){return!!e})};i.flatten=function(e){return i.reduce(e,[],function(e,t){if(i.isArray(t))return e.concat(i.flatten(t));e.push(t);return e})};i.without=function(e){var t=i.rest(arguments);return i.select(e,function(e){return!i.include(t,e)})};i.uniq=function(e,t){return i.reduce(e,[],function(e,n,r){(0==r||(t===!0?i.last(e)!=n:!i.include(e,n)))&&e.push(n);return e})};i.intersect=function(e){var t=i.rest(arguments);return i.select(i.uniq(e),function(e){return i.all(t,function(t){return i.indexOf(t,e)>=0})})};i.zip=function(){for(var e=i.toArray(arguments),t=i.max(i.pluck(e,"length")),n=new Array(t),r=0;r<t;r++)n[r]=i.pluck(e,String(r));return n};i.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1};i.lastIndexOf=function(e,t){if(e.lastIndexOf)return e.lastIndexOf(t);for(var n=e.length;n--;)if(e[n]===t)return n;return-1};i.range=function(e,t,n){var r=i.toArray(arguments),s=r.length<=1;e=s?0:r[0];t=s?r[0]:r[1];n=r[2]||1;r=Math.ceil((t-e)/n);if(r<=0)return[];r=new Array(r);s=e;for(var o=0;1;s+=n){if((n>0?s-t:t-s)>=0)return r;r[o++]=s}};i.bind=function(t,n){var r=i.rest(arguments,2);return function(){return t.apply(n||e,r.concat(i.toArray(arguments)))}};i.bindAll=function(e){var t=i.rest(arguments);t.length==0&&(t=i.functions(e));i.each(t,function(t){e[t]=i.bind(e[t],e)});return e};i.delay=function(e,t){var n=i.rest(arguments,2);return setTimeout(function(){return e.apply(e,n)},t)};i.defer=function(e){return i.delay.apply(i,[e,1].concat(i.rest(arguments)))};i.wrap=function(e,t){return function(){var n=[e].concat(i.toArray(arguments));return t.apply(t,n)}};i.compose=function(){var e=i.toArray(arguments);return function(){for(var t=i.toArray(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}};i.keys=function(e){if(i.isArray(e))return i.range(0,e.length);var t=[];for(var n in e)a.call(e,n)&&t.push(n);return t};i.values=function(e){return i.map(e,i.identity)};i.functions=function(e){return i.select(i.keys(e),function(t){return i.isFunction(e[t])}).sort()};i.extend=function(e,t){for(var n in t)e[n]=t[n];return e};i.clone=function(e){return i.isArray(e)?e.slice(0):i.extend({},e)};i.tap=function(e,t){t(e);return e};i.isEqual=function(e,t){if(e===t)return!0;var n=typeof e;if(n!=typeof t)return!1;if(e==t)return!0;if(!e&&t||e&&!t)return!1;if(e.isEqual)return e.isEqual(t);if(i.isDate(e)&&i.isDate(t))return e.getTime()===t.getTime();if(i.isNaN(e)&&i.isNaN(t))return!0;if(i.isRegExp(e)&&i.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline;if(n!=="object")return!1;if(e.length&&e.length!==t.length)return!1;n=i.keys(e);var r=i.keys(t);if(n.length!=r.length)return!1;for(var s in e)if(!i.isEqual(e[s],t[s]))return!1;return!0};i.isEmpty=function(e){return i.keys(e).length==0};i.isElement=function(e){return!!e&&e.nodeType==1};i.isArray=function(e){return!!(e&&e.concat&&e.unshift)};i.isArguments=function(e){return e&&i.isNumber(e.length)&&!i.isArray(e)&&!f.call(e,"length")};i.isFunction=function(e){return!!(e&&e.constructor&&e.call&&e.apply)};i.isString=function(e){return!!(e===""||e&&e.charCodeAt&&e.substr)};i.isNumber=function(e){return u.call(e)==="[object Number]"};i.isDate=function(e){return!!(e&&e.getTimezoneOffset&&e.setUTCFullYear)};i.isRegExp=function(e){return!(!(e&&e.test&&e.exec)||!e.ignoreCase&&e.ignoreCase!==!1)};i.isNaN=function(e){return i.isNumber(e)&&isNaN(e)};i.isNull=function(e){return e===null};i.isUndefined=function(e){return typeof e=="undefined"};i.noConflict=function(){e._=t;return this};i.identity=function(e){return e};i.breakLoop=function(){throw r};var l=0;i.uniqueId=function(e){var t=l++;return e?e+t:t};i.template=function(e,t){e=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');");return t?e(t):e};i.forEach=i.each;i.foldl=i.inject=i.reduce;i.foldr=i.reduceRight;i.filter=i.select;i.every=i.all;i.some=i.any;i.head=i.first;i.tail=i.rest;i.methods=i.functions;var c=function(e,t){return t?i(e).chain():e};i.each(i.functions(i),function(e){var t=i[e];n.prototype[e]=function(){var e=i.toArray(arguments);o.call(e,this._wrapped);return c(t.apply(i,e),this._chain)}});i.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Array.prototype[e];n.prototype[e]=function(){t.apply(this._wrapped,arguments);return c(this._wrapped,this._chain)}});i.each(["concat","join","slice"],function(e){var t=Array.prototype[e];n.prototype[e]=function(){return c(t.apply(this._wrapped,arguments),this._chain)}});n.prototype.chain=function(){this._chain=!0;return this};n.prototype.value=function(){return this._wrapped}})();